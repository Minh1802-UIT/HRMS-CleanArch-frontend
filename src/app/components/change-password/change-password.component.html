<div
  class="flex min-h-screen items-center justify-center bg-background-light dark:bg-background-dark px-4 py-12"
>
  <div
    class="w-full max-w-md rounded-2xl bg-surface-light dark:bg-[#1e1108] shadow-lg p-8 border border-[#e8d5cc] dark:border-[#3a2a22]"
  >
    <!-- Header -->
    <div class="mb-8 text-center">
      <div
        class="mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-full bg-primary/10"
      >
        <svg
          class="h-8 w-8 text-primary"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"
          />
        </svg>
      </div>
      <h2 class="text-2xl font-bold text-[#1c120d] dark:text-white">
        Set Your Password
      </h2>
      <p class="mt-2 text-sm text-[#9c6549] dark:text-[#ccb0a1]">
        Your account was created with a temporary password.<br />
        Please set a new secure password to continue.
      </p>
    </div>

    <!-- Form -->
    <form
      [formGroup]="form"
      (ngSubmit)="onSubmit()"
      class="space-y-5"
      novalidate
    >
      <!-- Current (temporary) Password -->
      <div>
        <label
          for="currentPassword"
          class="block text-sm font-medium text-[#1c120d] dark:text-white mb-1.5"
        >
          Temporary Password
        </label>
        <input
          id="currentPassword"
          formControlName="currentPassword"
          type="password"
          autocomplete="current-password"
          placeholder="Enter the temporary password"
          class="w-full rounded-xl border border-[#e8d5cc] dark:border-[#4a362c] bg-white dark:bg-[#2e1f18] px-4 py-3 text-sm text-[#1c120d] dark:text-white placeholder-[#c9a899] focus:outline-none focus:ring-2 focus:ring-primary/60 transition"
        />
        @if (
          form.get("currentPassword")?.invalid &&
          form.get("currentPassword")?.touched
        ) {
          <p class="mt-1 text-xs text-red-500">
            Temporary password is required (min 6 characters).
          </p>
        }
      </div>

      <!-- New Password -->
      <div>
        <label
          for="newPassword"
          class="block text-sm font-medium text-[#1c120d] dark:text-white mb-1.5"
        >
          New Password
        </label>
        <input
          id="newPassword"
          formControlName="newPassword"
          type="password"
          autocomplete="new-password"
          placeholder="At least 8 characters"
          class="w-full rounded-xl border border-[#e8d5cc] dark:border-[#4a362c] bg-white dark:bg-[#2e1f18] px-4 py-3 text-sm text-[#1c120d] dark:text-white placeholder-[#c9a899] focus:outline-none focus:ring-2 focus:ring-primary/60 transition"
        />
        @if (
          form.get("newPassword")?.invalid && form.get("newPassword")?.touched
        ) {
          <p class="mt-1 text-xs text-red-500">
            New password must be at least 8 characters.
          </p>
        }
      </div>

      <!-- Confirm New Password -->
      <div>
        <label
          for="confirmPassword"
          class="block text-sm font-medium text-[#1c120d] dark:text-white mb-1.5"
        >
          Confirm New Password
        </label>
        <input
          id="confirmPassword"
          formControlName="confirmPassword"
          type="password"
          autocomplete="new-password"
          placeholder="Repeat new password"
          class="w-full rounded-xl border border-[#e8d5cc] dark:border-[#4a362c] bg-white dark:bg-[#2e1f18] px-4 py-3 text-sm text-[#1c120d] dark:text-white placeholder-[#c9a899] focus:outline-none focus:ring-2 focus:ring-primary/60 transition"
        />
        @if (
          form.hasError("passwordMismatch") &&
          form.get("confirmPassword")?.touched
        ) {
          <p class="mt-1 text-xs text-red-500">Passwords do not match.</p>
        }
      </div>

      <!-- Error Banner -->
      @if (errorMessage) {
        <div
          class="rounded-xl bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-700 px-4 py-3"
        >
          <p class="text-sm text-red-600 dark:text-red-400">
            {{ errorMessage }}
          </p>
        </div>
      }

      <!-- Submit -->
      <button
        type="submit"
        [disabled]="form.invalid || isLoading"
        class="w-full rounded-xl bg-primary px-4 py-3 text-sm font-bold text-white transition-opacity hover:opacity-90 focus:outline-none focus:ring-2 focus:ring-primary/60 disabled:cursor-not-allowed disabled:opacity-50"
      >
        @if (isLoading) {
          <span class="flex items-center justify-center gap-2">
            <svg class="h-4 w-4 animate-spin" viewBox="0 0 24 24" fill="none">
              <circle
                class="opacity-25"
                cx="12"
                cy="12"
                r="10"
                stroke="currentColor"
                stroke-width="4"
              />
              <path
                class="opacity-75"
                fill="currentColor"
                d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"
              />
            </svg>
            Changing Passwordâ€¦
          </span>
        } @else {
          Change Password
        }
      </button>
    </form>

    <!-- Footer -->
    <div class="mt-6 text-center">
      <button
        type="button"
        (click)="signOut()"
        class="text-sm text-[#9c6549] hover:text-primary hover:underline transition-colors dark:text-[#ccb0a1]"
      >
        Sign out instead
      </button>
    </div>
  </div>
</div>
